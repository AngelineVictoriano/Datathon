subtitle = "?",
x="Length of stay", y = "Share of free healthcare financing") +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot
ggplot(merged_data, aes(mean_LOS, expenditure_to_GDP, color = income_group)) +
geom_count(size = 2) +
labs(title="Correlation of LOS with spending",
subtitle = "?",
x="Length of stay", y = "Spending") +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot
merged_data %>%
filter(!country %in% c("Japan", "Korea")) %>%
ggplot(aes(mean_LOS, expenditure_to_GDP, color = income_group)) +
geom_count(size = 2) +
labs(title="Correlation of LOS with spending",
subtitle = "?",
x="Length of stay", y = "Spending") +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot with Japan removed
merged_data %>%
# filter(!country %in% c("Japan", "Korea")) %>%
ggplot(aes(mean_LOS, govt_contributions, color = income_group)) +
geom_count(size = 2) +
labs(title="Correlation of LOS with free healthcare",
subtitle = "?",
x="Length of stay", y = "Share of free healthcare financing") +
scale_color_brewer(palette="Dark2") +
theme_classic()
expenditure_data <- readRDS("C:/Users/kumar/mygithubpulls/Datathon/processed_data/expenditure_data.rds")
View(expenditure_data)
country_class <- readRDS("C:/Users/kumar/mygithubpulls/Datathon/processed_data/country_class.rds")
#UHC_trend <-
expenditure_data %>%
# retain first column (country) and extract govt and individual contributions
select(c(1, 2) | contains("Government/compulsory schemes")) %>%
# getting all expenditure (subgroup)
select(c(1) | contains("Current expenditure on health (all functions)")) %>%
# get data from all providers
select(c(1) | contains("All providers")) %>%
# get "share of current expenditure on health"
select(c(1) | contains("Share of current expenditure on health")) %>%
kbl()
library(tidyverse)
library(janitor)
library(kableExtra)
library(readxl)
#UHC_trend <-
expenditure_data %>%
# retain first column (country) and extract govt and individual contributions
select(c(1, 2) | contains("Government/compulsory schemes")) %>%
# getting all expenditure (subgroup)
select(c(1) | contains("Current expenditure on health (all functions)")) %>%
# get data from all providers
select(c(1) | contains("All providers")) %>%
# get "share of current expenditure on health"
select(c(1) | contains("Share of current expenditure on health")) %>%
kbl()
#UHC_trend <-
expenditure_data %>%
# retain first column (country) and extract govt and individual contributions
select(c(1, 2) | contains("Government/compulsory schemes")) %>%
# getting all expenditure (subgroup)
select(c(1, 2) | contains("Current expenditure on health (all functions)")) %>%
# get data from all providers
select(c(1, 2) | contains("All providers")) %>%
# get "share of current expenditure on health"
select(c(1, 2) | contains("Share of current expenditure on health")) %>%
kbl()
#UHC_trend <-
expenditure_data %>%
# retain first column (country) and extract govt and individual contributions
select(c(1, 2) | contains("Government/compulsory schemes")) %>%
# getting all expenditure (subgroup)
select(c(1, 2) | contains("Current expenditure on health (all functions)")) %>%
# get data from all providers
select(c(1, 2) | contains("All providers")) %>%
# get "share of current expenditure on health"
select(c(1, 2) | contains("Share of current expenditure on health")) %>%
# renaming column
rename(UHC_share = 3) %>%
kbl()
#UHC_trend <-
expenditure_data %>%
# retain first column (country) and extract govt and individual contributions
select(c(1, 2) | contains("Government/compulsory schemes")) %>%
# getting all expenditure (subgroup)
select(c(1, 2) | contains("Current expenditure on health (all functions)")) %>%
# get data from all providers
select(c(1, 2) | contains("All providers")) %>%
# get "share of current expenditure on health"
select(c(1, 2) | contains("Share of current expenditure on health")) %>%
# renaming column
rename(UHC_share = 3) %>%
# making year column as factors
mutate(UHC_share = as.factor(UHC_share)) %>%
kbl()
UHC_trend <- expenditure_data %>%
# retain first column (country) and extract govt and individual contributions
select(c(1, 2) | contains("Government/compulsory schemes")) %>%
# getting all expenditure (subgroup)
select(c(1, 2) | contains("Current expenditure on health (all functions)")) %>%
# get data from all providers
select(c(1, 2) | contains("All providers")) %>%
# get "share of current expenditure on health"
select(c(1, 2) | contains("Share of current expenditure on health")) %>%
# renaming column
rename(UHC_share = 3) %>%
# making year column as factors
mutate(UHC_share = as.factor(UHC_share))
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share)) +
geom_line()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line()
View(UHC_trend)
summarise(UHC_trend)
glimpse(UHC_trend)
UHC_trend <- expenditure_data %>%
# retain first column (country) and extract govt and individual contributions
select(c(1, 2) | contains("Government/compulsory schemes")) %>%
# getting all expenditure (subgroup)
select(c(1, 2) | contains("Current expenditure on health (all functions)")) %>%
# get data from all providers
select(c(1, 2) | contains("All providers")) %>%
# get "share of current expenditure on health"
select(c(1, 2) | contains("Share of current expenditure on health")) %>%
# renaming column
rename(UHC_share = 3) %>%
# making year column as factors
mutate(year = as.factor(year))
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = colors[3]) +
theme_classic()
subset(UHC_trend,  country == "India")
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red") +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United states"),color = "red") +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United states"),color = "Green") +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green") +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue") +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red") +
geom_point(data = subset(UHC_trend,  country == "India"),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue") +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red") +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue") +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 2) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue") +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.5) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue") +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue") +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus", year == 20222),color = "Blue") +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
theme_classic()
# plotting the UHC trend
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
scale_color_manual(name='Regression Model',
breaks=c('Linear', 'Quadratic', 'Cubic'),
values=c('Cubic'='pink', 'Quadratic'='blue', 'Linear'='purple'))+
theme_classic()
# plotting the UHC trend
library(ggrepel)
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_text_repel() +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
theme_classic()
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red",  label = country) +
geom_text_repel() +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
theme_classic()
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_text_repel(label = country) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
theme_classic()
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
theme_classic()
p1 < - UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
theme_classic()
p1 <- UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
theme_classic()
india_line <- geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red")
india_line <- ggplot() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red")
p1 + india_line
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
p1 +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red")
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue")
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue")
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue")
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue")
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(aes(label = country),
nudge_x = 1,
na.rm = TRUE) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue")
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(subset(UHC_trend,  country == "India" & year == 2019), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue")
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(data = subset(UHC_trend,  country == "India" & year == 2019), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue")
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(data = subset(UHC_trend,  country == "India" & year == 2019), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_label_repel(data = subset(UHC_trend,  country == "United States" & year == 2020), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue")
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(data = subset(UHC_trend,  country == "India" & year == 2019), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_label_repel(data = subset(UHC_trend,  country == "United States" & year == 2020), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
geom_label_repel(data = subset(UHC_trend,  country == "Cyprus" & year == 2020), aes(label = country),
nudge_x = 1) +
theme_classic()
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(data = subset(UHC_trend,  country == "India" & year == 2019), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_label_repel(data = subset(UHC_trend,  country == "United States" & year == 2020), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
geom_label_repel(data = subset(UHC_trend,  country == "Cyprus" & year == 2020), aes(label = country),
nudge_x = 1) +
labs(title="Correlation of LOS with free healthcare",
subtitle = "?",
x="Length of stay", y = "Share of free healthcare financing") +
scale_color_brewer(palette="Dark2") +
theme_classic()
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(data = subset(UHC_trend,  country == "India" & year == 2019), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_label_repel(data = subset(UHC_trend,  country == "United States" & year == 2020), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
geom_label_repel(data = subset(UHC_trend,  country == "Cyprus" & year == 2020), aes(label = country),
nudge_x = 1) +
labs(title="Trend of ",
subtitle = "?",
x="Years", y = "Share of compulsory healthcare financing") +
theme_classic()
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(data = subset(UHC_trend,  country == "India" & year == 2019), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_label_repel(data = subset(UHC_trend,  country == "United States" & year == 2020), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
geom_label_repel(data = subset(UHC_trend,  country == "Cyprus" & year == 2020), aes(label = country),
nudge_x = 1) +
labs(title="Trend of universal healthcare by countries",
subtitle = "The hightlighted countries shows significant increase",
x="Years", y = "Share of compulsory healthcare financing") +
theme_classic()
