# knee replacement
# cataract waiting
knee_replacement <- oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Knee replacement")) %>%
select(c(1) | contains("Waiting times of patients on the list: Mean (days)")) %>%
rename(knee_replacement = 2) %>%
# group the rows by countries and get mean of scans
group_by(country) %>%
summarise(mean_knee_replacement_waiting_time = mean(knee_replacement, na.rm = TRUE)) %>%
drop_na(2) %>%
kbl()
############################
# knee replacement
# cataract waiting
knee_replacement <- oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Knee replacement")) %>%
select(c(1) | contains("Waiting times of patients on the list: Mean (days)")) %>%
rename(knee_replacement = 2) %>%
# group the rows by countries and get mean of scans
group_by(country) %>%
summarise(mean_knee_replacement_waiting_time = mean(knee_replacement, na.rm = TRUE)) %>%
drop_na(2)
########### merging ########
merged_data <- income_and_spending_with_share %>%
inner_join(knee_replacement, by = c("country"))
# Scatterplot
merged_data %>%
ggplot() +
geom_count(aes(mean_knee_replacement_waiting_time, expenditure_to_GDP, color = income_group), size = 2) +
labs(title="Correlation of waiting times for cataract surgery with spending",
subtitle = "?",
x="Mean number of days for cataract surgery specilist assesement", y = "Healthcare expenditure") +
geom_smooth(aes(mean_knee_replacement_waiting_time, expenditure_to_GDP), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot
merged_data %>%
ggplot() +
geom_count(aes(mean_knee_replacement_waiting_time, expenditure_to_GDP, color = income_group), size = 2) +
labs(title="Correlation of waiting times for knee replacement with spending",
subtitle = "?",
x="Mean number of days for knee replacement waiting list", y = "Healthcare expenditure") +
geom_smooth(aes(mean_knee_replacement_waiting_time, expenditure_to_GDP), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot with UHC
merged_data %>%
ggplot() +
geom_count(aes(mean_knee_replacement_waiting_time, govt_contributions, color = income_group), size = 2) +
labs(title="Correlation of waiting times with UHC",
subtitle = "?",
x="Mean number of days for knee replacement specilist assesement", y = "Healthcare expenditure") +
geom_smooth(aes(mean_knee_replacement_waiting_time, govt_contributions), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
library(tidyverse)
library(janitor)
library(kableExtra)
library(readxl)
# reading world bank income data
country_class_raw <- read_excel("CLASS.xlsx")
# reading world bank income data
country_class_raw <- read_excel(here::here("raw_data", "CLASS.xlsx"))
View(country_class_raw)
country_class <- country_class_raw %>%
rename(country = Economy, income_group = "Income group") %>%
select(country, Region, income_group) %>%
mutate(income_group = factor(income_group, levels = c("Low income", "Lower middle income", "Upper middle income", "High income")))
# plotting
merged_data %>%  ggplot(aes(x=reorder(country, expenditure_to_GDP), y = expenditure_to_GDP, fill = Income_group)) +
geom_bar(stat='identity', width=.4) +
labs(title = "Barplot showing Healthcare expenditure by each country",
subtitle = "as percentage of GDP",
x = "Coutries",
y = "Healthcare expenditure (% of GDP)",
fill = "Income level") +
coord_flip()
income_and_spending_with_share <- readRDS("C:/Users/kumar/mygithubpulls/Datathon/processed_data/income_and_spending_with_share.rds")
# plotting
income_and_spending_with_share %>%  ggplot(aes(x=reorder(country, expenditure_to_GDP), y = expenditure_to_GDP, fill = Income_group)) +
geom_bar(stat='identity', width=.4) +
labs(title = "Barplot showing Healthcare expenditure by each country",
subtitle = "as percentage of GDP",
x = "Coutries",
y = "Healthcare expenditure (% of GDP)",
fill = "Income level") +
coord_flip()
# plotting
income_and_spending_with_share %>%  ggplot(aes(x=reorder(country, expenditure_to_GDP), y = expenditure_to_GDP, fill = income_group)) +
geom_bar(stat='identity', width=.4) +
labs(title = "Barplot showing Healthcare expenditure by each country",
subtitle = "as percentage of GDP",
x = "Coutries",
y = "Healthcare expenditure (% of GDP)",
fill = "Income level") +
coord_flip()
View(income_and_spending_with_share)
income_and_spending_with_share %>%
ggplot(aes(x=reorder(country, expenditure_to_GDP), y = expenditure_to_GDP, fill = income_group)) +
geom_bar(stat='identity', width=.5) +
labs(title = "Healthcare expenditure by countries",
subtitle = "As proportion of its GDP for the year 2019",
x = "Coutries",
y = "Expenditure as % of GDP",
fill = "Income level") +
coord_flip() +
scale_fill_ipsum() +
theme_classic()
install.packages(hrbrthemes)
install.packages("hrbrthemes")
library(hrbrthemes)
income_and_spending_with_share %>%
ggplot(aes(x=reorder(country, expenditure_to_GDP), y = expenditure_to_GDP, fill = income_group)) +
geom_bar(stat='identity', width=.5) +
labs(title = "Healthcare expenditure by countries",
subtitle = "As proportion of its GDP for the year 2019",
x = "Coutries",
y = "Expenditure as % of GDP",
fill = "Income level") +
coord_flip() +
scale_fill_ipsum() +
theme_classic()
merged_income_data <- readRDS("C:/Users/kumar/mygithubpulls/Datathon/processed_data/merged_income_data.rds")
merged_income_data %>%
ggplot(aes(x=reorder(country, expenditure_to_GDP), y = expenditure_to_GDP, fill = income_group)) +
geom_bar(stat='identity', width=.5) +
labs(title = "Healthcare expenditure by countries",
subtitle = "As proportion of its GDP for the year 2019",
x = "Coutries",
y = "Expenditure as % of GDP",
fill = "Income level") +
coord_flip() +
scale_fill_ipsum() +
theme_classic()
share_of_expenditure <- readRDS("C:/Users/kumar/mygithubpulls/Datathon/processed_data/share_of_expenditure.rds")
View(share_of_expenditure)
share_of_expenditure_longer <- merged_income_data %>%
select(country, govt_contributions, individual_contributions, unknown_contributions) %>%
# making the data frame longer for better plotting. Using pivot longer function
pivot_longer(!country, names_to = "contributions_type", values_to = "contributions")
# Grouped
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="dodge", stat="identity") +
coord_flip()
# Grouped but with stacked
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="fill", stat="identity") +
labs(title = "Stacked bar chart showing share of healthcare expenditure  year 2019",
subtitle = "between governament and individual contributions (voluntary schemes or out-of-pocket)",
x = "Countries",
y = "Share of expenditure",
fill = "Portion of share") +
scale_y_continuous(labels = scales::percent) +
scale_fill_discrete(labels=c('Governament', 'Individual', 'Unknown')) +
coord_flip()
# Grouped but with stacked
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="fill", stat="identity") +
labs(title = "Stacked bar chart showing share of healthcare expenditure  year 2019",
subtitle = "between governament and individual contributions (voluntary schemes or out-of-pocket)",
x = "Countries",
y = "Share of expenditure",
fill = "Portion of share") +
scale_y_continuous(labels = scales::percent) +
scale_fill_discrete(labels=c('Governament', 'Individual', 'Unknown')) +
coord_flip()
View(share_of_expenditure_longer)
# selecting only contribution share data (alternatively could have used initial data frame)
share_of_expenditure_longer <- merged_income_data %>%
select(country, govt_contributions, individual_contributions, unknown_contributions) %>%
# making the data frame longer for better plotting. Using pivot longer function
pivot_longer(!country, names_to = "contributions_type", values_to = "contributions") %>%
arrange(desc(contributions))
# Grouped but with stacked
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="fill", stat="identity") +
labs(title = "Stacked bar chart showing share of healthcare expenditure  year 2019",
subtitle = "between governament and individual contributions (voluntary schemes or out-of-pocket)",
x = "Countries",
y = "Share of expenditure",
fill = "Portion of share") +
scale_y_continuous(labels = scales::percent) +
scale_fill_discrete(labels=c('Governament', 'Individual', 'Unknown')) +
coord_flip()
merged_income_data <- merged_income_data %>%
arrange(desc(govt_contributions))
# selecting only contribution share data (alternatively could have used initial data frame)
share_of_expenditure_longer <- merged_income_data %>%
select(country, govt_contributions, individual_contributions, unknown_contributions) %>%
# making the data frame longer for better plotting. Using pivot longer function
pivot_longer(!country, names_to = "contributions_type", values_to = "contributions")
# Grouped but with stacked
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="fill", stat="identity") +
labs(title = "Stacked bar chart showing share of healthcare expenditure  year 2019",
subtitle = "between governament and individual contributions (voluntary schemes or out-of-pocket)",
x = "Countries",
y = "Share of expenditure",
fill = "Portion of share") +
scale_y_continuous(labels = scales::percent) +
scale_fill_discrete(labels=c('Governament', 'Individual', 'Unknown')) +
coord_flip()
merged_income_data <- merged_income_data %>%
arrange(govt_contributions)
# selecting only contribution share data (alternatively could have used initial data frame)
share_of_expenditure_longer <- merged_income_data %>%
select(country, govt_contributions, individual_contributions, unknown_contributions) %>%
# making the data frame longer for better plotting. Using pivot longer function
pivot_longer(!country, names_to = "contributions_type", values_to = "contributions")
# Grouped but with stacked
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="fill", stat="identity") +
labs(title = "Stacked bar chart showing share of healthcare expenditure  year 2019",
subtitle = "between governament and individual contributions (voluntary schemes or out-of-pocket)",
x = "Countries",
y = "Share of expenditure",
fill = "Portion of share") +
scale_y_continuous(labels = scales::percent) +
scale_fill_discrete(labels=c('Governament', 'Individual', 'Unknown')) +
coord_flip()
# Grouped but with stacked
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="fill", stat="identity", width=.5) +
labs(title = "Stacked bar chart showing share of healthcare expenditure  year 2019",
subtitle = "between governament and individual contributions (voluntary schemes or out-of-pocket)",
x = "Countries",
y = "Share of expenditure",
fill = "Portion of share") +
scale_y_continuous(labels = scales::percent) +
scale_fill_discrete(labels=c('Governament', 'Individual', 'Unknown')) +
coord_flip()
# Grouped but with stacked
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="fill", stat="identity", width=.5) +
labs(title = "Stacked bar chart showing share of healthcare expenditure  year 2019",
subtitle = "between governament and individual contributions (voluntary schemes or out-of-pocket)",
x = "Countries",
y = "Share of expenditure",
fill = "Portion of share") +
scale_y_continuous(labels = scales::percent) +
scale_fill_discrete(labels=c('Governament', 'Individual', 'Unknown')) +
coord_flip() +
scale_fill_ipsum() +
theme_classic()
# Grouped but with stacked
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="fill", stat="identity", width=.6) +
labs(title = "Share of healthcare expenditure by type",
subtitle = "Between compulsory/governament and individual contributions",
x = "Countries",
y = "Share of expenditure",
fill = "Portion of share") +
scale_y_continuous(labels = scales::percent) +
scale_fill_ipsum() +
theme_classic() +
scale_fill_discrete(labels=c('Governament', 'Individual', 'Unknown')) +
coord_flip()
# Grouped but with stacked
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="fill", stat="identity", width=.6) +
labs(title = "Share of healthcare expenditure by type",
subtitle = "Between compulsory/governament and individual contributions",
x = "Countries",
y = "Share of expenditure",
fill = "Portion of share") +
scale_y_continuous(labels = scales::percent) +
scale_fill_ipsum() +
theme_classic() +
coord_flip()
# Grouped but with stacked
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="fill", stat="identity", width=.6) +
labs(title = "Share of healthcare expenditure by type",
subtitle = "Between compulsory/governament and individual contributions",
x = "Countries",
y = "Share of expenditure",
fill = "Portion of share") +
scale_y_continuous(labels = scales::percent) +
scale_fill_ipsum(labels=c('Governament', 'Individual', 'Unknown')) +
theme_classic() +
coord_flip()
merged_income_data %>%
ggplot(aes(x=reorder(country, expenditure_to_GDP), y = expenditure_to_GDP, fill = income_group)) +
geom_bar(stat='identity', width=.5) +
labs(title = "Healthcare expenditure by countries",
subtitle = "As proportion of its GDP for the year 2019",
x = "Countries",
y = "Expenditure as % of GDP",
fill = "Income level") +
coord_flip() +
scale_fill_ipsum() +
scale_y_continuous(labels = scales::percent) +
theme_classic()
# Grouped but with stacked
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="fill", stat="identity", width=.6) +
labs(title = "Share of healthcare expenditure by type",
subtitle = "Between compulsory/governament and individual contributions",
x = "Countries",
y = "Share of expenditure",
fill = "Portion of share") +
scale_y_continuous(labels = scales::percent) +
scale_fill_ipsum() +
theme_classic() +
coord_flip()
# Grouped but with stacked
share_of_expenditure_longer %>%
ggplot(aes(x=fct_inorder(country), y=contributions, fill=contributions_type)) +
geom_bar(position="fill", stat="identity", width=.6) +
labs(title = "Share of healthcare expenditure by type",
subtitle = "Between compulsory/governament and individual contributions",
x = "Countries",
y = "Share of expenditure",
fill = "Portion of share") +
scale_y_continuous(labels = scales::percent) +
scale_fill_ipsum(labels=c('Governament', 'Individual', 'Unknown')) +
theme_classic() +
coord_flip()
df_for_plotting <- consultations %>%
inner_join(merged_income_data, by = c("country"))
# consultations
consultations <- oecd_data %>%
# selecting first column (country) and columns containing "doctors"
select(c(1,2) | contains("Doctors")) %>%
#renaming the column names
rename(consultations = 3) %>%
# getting average across the years
group_by(country) %>%
summarise(mean_consultations = mean(consultations, na.rm = TRUE)) %>%
drop_na(2)
oecd_data <- readRDS("C:/Users/kumar/mygithubpulls/Datathon/processed_data/oecd_data.rds")
# consultations
consultations <- oecd_data %>%
# selecting first column (country) and columns containing "doctors"
select(c(1,2) | contains("Doctors")) %>%
#renaming the column names
rename(consultations = 3) %>%
# getting average across the years
group_by(country) %>%
summarise(mean_consultations = mean(consultations, na.rm = TRUE)) %>%
drop_na(2)
df_for_plotting <- consultations %>%
inner_join(merged_income_data, by = c("country"))
# plotting
df_for_plotting %>%
ggplot(aes(x=mean_consultations, y = expenditure_to_GDP, shape = income_group, color = income_group)) +
geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, fullrange=FALSE) +
labs(title="Correlation of number of consultations with health expenditure",
subtitle = "is investing more in health reduces number of health consultations?",
x="Number of consultations per capita", y = "Health expenditure as percentage of GDP") +
scale_color_brewer(palette="Dark2") +
theme_classic()
# plotting
df_for_plotting %>%
ggplot(aes(x=mean_consultations, y = expenditure_to_GDP, shape = income_group, color = income_group)) +
geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, fullrange=FALSE) +
labs(title="Correlation of number of consultations with health expenditure",
subtitle = "is investing more in health reduces number of health consultations?",
x="Number of consultations per capita", y = "Health expenditure as percentage of GDP") +
scale_fill_ipsum() +
theme_classic()
# plotting
df_for_plotting %>%
ggplot(aes(x=mean_consultations, y = expenditure_to_GDP, color = income_group)) +
geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, fullrange=FALSE) +
labs(title="Correlation of number of consultations with health expenditure",
subtitle = "is investing more in health reduces number of health consultations?",
x="Number of consultations per capita", y = "Health expenditure as percentage of GDP") +
scale_fill_ipsum() +
theme_classic()
# plotting
df_for_plotting %>%
ggplot(aes(x=mean_consultations, y = expenditure_to_GDP, color = income_group)) +
geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, fullrange=FALSE) +
labs(title="Correlation of number of consultations with health expenditure",
subtitle = "is investing more in health reduces number of health consultations?",
x="Number of consultations per capita",
y = "Health expenditure as percentage of GDP"
color = "Income group") +
# plotting
df_for_plotting %>%
ggplot(aes(x=mean_consultations, y = expenditure_to_GDP, color = income_group)) +
geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, fullrange=FALSE) +
labs(title="Correlation of number of consultations with health expenditure",
subtitle = "is investing more in health reduces number of health consultations?",
x="Number of consultations per capita",
y = "Health expenditure as percentage of GDP",
color = "Income group") +
scale_fill_ipsum() +
theme_classic()
# plotting
df_for_plotting %>%
ggplot(aes(x=mean_consultations, y = expenditure_to_GDP, color = income_group)) +
geom_point(size = 3) +
geom_smooth(method=lm, se=FALSE, fullrange=FALSE, alpha = 0.5) +
labs(title="Correlation of number of consultations with health expenditure",
subtitle = "is investing more in health reduces number of health consultations?",
x="Number of consultations per capita",
y = "Health expenditure as percentage of GDP",
color = "Income group") +
scale_fill_ipsum() +
theme_classic()
# plotting
df_for_plotting %>%
ggplot(aes(x=mean_consultations, y = expenditure_to_GDP, color = income_group)) +
geom_point(size = 3, alpha = 0.5) +
geom_smooth(method=lm, se=FALSE, fullrange=FALSE) +
labs(title="Correlation of number of consultations with health expenditure",
subtitle = "is investing more in health reduces number of health consultations?",
x="Number of consultations per capita",
y = "Health expenditure as percentage of GDP",
color = "Income group") +
scale_fill_ipsum() +
theme_classic()
# plotting
df_for_plotting %>%
ggplot(aes(x=mean_consultations, y = govt_contributions, color = income_group, size = expenditure_to_GDP)) +
geom_point(alpha=0.7) +
labs(title="Correlation of number of consultations with health expenditure",
subtitle = "is there a relationship with free healthcare and number of consultations?",
x="Number of consultations per capita",
y = "Share of govt or compulsary healthcare financing",
color = "Income group",
size="Amount as percentage of GDP") +
scale_color_brewer(palette="Dark2") +
theme_classic()
mean_immunization <- oecd_data %>%
# selecting country column and Immunization columns
select(c(2) | contains("Immunisation")) %>%
# group the rows by countries and get mean of immunization values
group_by(country) %>%
summarise(across(everything(), list(mean), na.rm = TRUE)) %>%
# renaming the columns as good variable format
rename(hepatitis = 2, influenza=3, DPT=4, Measles=5)
# merging with income data
df_for_plotting <- mean_immunization %>%
inner_join(merged_income_data, by = c("country"))
df_for_plotting %>%
ggplot(aes(x=influenza, y = expenditure_to_GDP, color = income_group)) +
geom_point(size = 3, alpha = 0.5) +
geom_smooth(method=lm, se=FALSE) +
labs(title="Correlation of influenza immunisation coverage with health expenditure",
subtitle = "Is higher spending correlates with higher immunisation cover?",
x="Percentage of people covered",
y = "Health expenditure as percentage of GDP",
color = "Income group") +
scale_color_brewer(palette="Dark2") +
theme_classic()
df_for_plotting %>%
ggplot(aes(x=influenza, y = expenditure_to_GDP, color = income_group)) +
geom_point(size = 3, alpha = 0.5) +
geom_smooth(method=lm, se=FALSE) +
labs(title="Correlation of influenza immunisation coverage with health expenditure",
subtitle = "Is higher spending correlates with higher immunisation cover?",
x="Percentage of people covered",
y = "Health expenditure as percentage of GDP",
color = "Income group") +
# scale_color_brewer(palette="Dark2") +
scale_fill_ipsum() +
theme_classic()
df_for_plotting %>%
ggplot(aes(x=influenza, y = expenditure_to_GDP, color = income_group)) +
geom_point(size = 3, alpha = 0.5) +
geom_smooth(method=lm, se=FALSE) +
labs(title="Correlation of influenza immunisation coverage with health expenditure",
subtitle = "Is higher spending correlates with higher immunisation cover?",
x="Percentage of people covered",
y = "Health expenditure as percentage of GDP",
color = "Income group") +
scale_fill_ipsum() +
theme_classic()
# plotting
df_for_plotting %>%
ggplot(aes(x=influenza, y = govt_contributions, color = income_group, size = expenditure_to_GDP)) +
geom_point(alpha=0.7) +
labs(title="Correlation of influensa vaccination cover with health expenditure",
subtitle = " bimodal distribution of influensa coverate with health expenditure?",
x="influensa vaccine coverage", y = "Share of govt or compulsary healthcare financing",
color = "Income group",
size="Amount as percentage of GDP") +
scale_color_brewer(palette="Dark2") +
theme_classic()
df_for_plotting %>%
ggplot(aes(x=influenza, y = expenditure_to_GDP, color = income_group)) +
geom_point(size = 3, alpha = 0.5) +
geom_smooth(method=lm, se=FALSE) +
labs(title="Correlation of influenza immunisation coverage with health expenditure",
subtitle = "Is higher spending correlates with higher immunisation cover?",
x="Percentage of people covered",
y = "Health expenditure as percentage of GDP",
color = "Income group") +
scale_fill_ipsum() +
theme_classic()
