geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue")
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(data = subset(UHC_trend,  country == "India" & year == 2019), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_label_repel(data = subset(UHC_trend,  country == "United States" & year == 2020), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
geom_label_repel(data = subset(UHC_trend,  country == "Cyprus" & year == 2020), aes(label = country),
nudge_x = 1) +
theme_classic()
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(data = subset(UHC_trend,  country == "India" & year == 2019), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_label_repel(data = subset(UHC_trend,  country == "United States" & year == 2020), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
geom_label_repel(data = subset(UHC_trend,  country == "Cyprus" & year == 2020), aes(label = country),
nudge_x = 1) +
labs(title="Correlation of LOS with free healthcare",
subtitle = "?",
x="Length of stay", y = "Share of free healthcare financing") +
scale_color_brewer(palette="Dark2") +
theme_classic()
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(data = subset(UHC_trend,  country == "India" & year == 2019), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_label_repel(data = subset(UHC_trend,  country == "United States" & year == 2020), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
geom_label_repel(data = subset(UHC_trend,  country == "Cyprus" & year == 2020), aes(label = country),
nudge_x = 1) +
labs(title="Trend of ",
subtitle = "?",
x="Years", y = "Share of compulsory healthcare financing") +
theme_classic()
UHC_trend %>%
ggplot(aes(x=year, y = UHC_share, group = country)) +
geom_line() +
geom_line(data = subset(UHC_trend,  country == "India"),color = "red", size = 1.25) +
geom_point(data = subset(UHC_trend,  country == "India" & year == 2019),color = "red") +
geom_label_repel(data = subset(UHC_trend,  country == "India" & year == 2019), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "United States"),color = "Green", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "United States" & year == 2022),color = "Green") +
geom_label_repel(data = subset(UHC_trend,  country == "United States" & year == 2020), aes(label = country),
nudge_x = 1) +
geom_line(data = subset(UHC_trend,  country == "Cyprus"),color = "Blue", size = 1.25) +
geom_line(data = subset(UHC_trend,  country == "Cyprus" & year == 20222),color = "Blue") +
geom_label_repel(data = subset(UHC_trend,  country == "Cyprus" & year == 2020), aes(label = country),
nudge_x = 1) +
labs(title="Trend of universal healthcare by countries",
subtitle = "The hightlighted countries shows significant increase",
x="Years", y = "Share of compulsory healthcare financing") +
theme_classic()
country_class <- readRDS("C:/Users/kumar/mygithubpulls/Datathon/processed_data/country_class.rds")
oecd_data <- readRDS("C:/Users/kumar/mygithubpulls/Datathon/processed_data/oecd_data.rds")
income_and_spending_with_share <- readRDS("C:/Users/kumar/mygithubpulls/Datathon/processed_data/income_and_spending_with_share.rds")
# importing libraries
library(tidyverse)
library(janitor)
library(kableExtra)
library(readxl)
# number of CT scans
# length of stay
#CT_scans <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Computed Tomography exams")) %>%
kbl()
# number of CT scans
# length of stay
#CT_scans <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Computed Tomography exams, total")) %>%
kbl()
# number of CT scans
# length of stay
#CT_scans <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Computed Tomography exams, total")) %>%
select(c(1) | contains("Per 1 000 population")) %>%
kbl()
# number of CT scans
# length of stay
#CT_scans <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Computed Tomography exams, total")) %>%
select(c(1) | contains("Per 1 000 population")) %>%
# renaming column
rename(CT_scans = 2) %>%
# group the rows by countries and get mean of scans
group_by(country) %>%
summarise(mean_CT_scans = mean(CT_scans, na.rm = TRUE)) %>%
drop_na(2) %>%
kbl()
########### merging ########
merged_data <- income_and_spending_with_share %>%
full_join(CT_scans, by = c("country"))
# number of CT scans
# length of stay
CT_scans <- oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Computed Tomography exams, total")) %>%
select(c(1) | contains("Per 1 000 population")) %>%
# renaming column
rename(CT_scans = 2) %>%
# group the rows by countries and get mean of scans
group_by(country) %>%
summarise(mean_CT_scans = mean(CT_scans, na.rm = TRUE)) %>%
drop_na(2)
########### merging ########
merged_data <- income_and_spending_with_share %>%
full_join(CT_scans, by = c("country"))
View(merged_data)
########### merging ########
merged_data <- income_and_spending_with_share %>%
inner_join(CT_scans, by = c("country"))
# Scatterplot
merged_data %>%
# filter(!country %in% c("Japan", "Korea")) %>%
ggplot(aes(mean_CT_scans, expenditure_to_GDP, color = income_group)) +
geom_count(size = 2) +
labs(title="Correlation of LOS with spending",
subtitle = "?",
x="Length of stay", y = "Spending") +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot
merged_data %>%
# filter(!country %in% c("Japan", "Korea")) %>%
ggplot(aes(mean_CT_scans, expenditure_to_GDP, color = income_group)) +
geom_count(size = 2) +
labs(title="Correlation of number of diagnositc exams with spending",
subtitle = "?",
x="Number of CT scans per 1000 population", y = "Healthcare expenditure") +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot
merged_data %>%
# filter(!country %in% c("Japan", "Korea")) %>%
ggplot(aes(mean_CT_scans, expenditure_to_GDP, color = income_group)) +
geom_count(size = 2) +
labs(title="Correlation of number of diagnositc exams with spending",
subtitle = "?",
x="Number of CT scans per 1000 population", y = "Healthcare expenditure") +
geom_smooth(method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot
merged_data %>%
# filter(!country %in% c("Japan", "Korea")) %>%
ggplot(aes(mean_CT_scans, expenditure_to_GDP, color = income_group)) +
geom_count(size = 2) +
labs(title="Correlation of number of diagnositc exams with spending",
subtitle = "?",
x="Number of CT scans per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_CT_scans, expenditure_to_GDP, color = income_group), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot
merged_data %>%
# filter(!country %in% c("Japan", "Korea")) %>%
ggplot(aes(mean_CT_scans, expenditure_to_GDP, color = income_group)) +
geom_count(size = 2) +
labs(title="Correlation of number of diagnositc exams with spending",
subtitle = "?",
x="Number of CT scans per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_CT_scans, expenditure_to_GDP), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot
merged_data %>%
# filter(!country %in% c("Japan", "Korea")) %>%
ggplot() +
geom_count(aes(mean_CT_scans, expenditure_to_GDP, color = income_group), size = 2) +
labs(title="Correlation of number of diagnositc exams with spending",
subtitle = "?",
x="Number of CT scans per 1000 population", y = "Healthcare expenditure") +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot
merged_data %>%
# filter(!country %in% c("Japan", "Korea")) %>%
ggplot() +
geom_count(aes(mean_CT_scans, expenditure_to_GDP, color = income_group), size = 2) +
labs(title="Correlation of number of diagnositc exams with spending",
subtitle = "?",
x="Number of CT scans per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_CT_scans, expenditure_to_GDP))
# Scatterplot
merged_data %>%
# filter(!country %in% c("Japan", "Korea")) %>%
ggplot() +
geom_count(aes(mean_CT_scans, expenditure_to_GDP, color = income_group), size = 2) +
labs(title="Correlation of number of diagnositc exams with spending",
subtitle = "?",
x="Number of CT scans per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_CT_scans, expenditure_to_GDP), method=lm, se=FALSE)
# Scatterplot
merged_data %>%
# filter(!country %in% c("Japan", "Korea")) %>%
ggplot() +
geom_count(aes(mean_CT_scans, expenditure_to_GDP, color = income_group), size = 2) +
labs(title="Correlation of number of diagnositc exams with spending",
subtitle = "?",
x="Number of CT scans per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_CT_scans, expenditure_to_GDP), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot with universal healthcare
merged_data %>%
ggplot() +
geom_count(aes(mean_CT_scans, govt_contributions, color = income_group), size = 2) +
labs(title="Correlation of number of diagnositc exams with spending",
subtitle = "?",
x="Number of CT scans per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_CT_scans, expenditure_to_GDP), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot with universal healthcare
merged_data %>%
ggplot() +
geom_count(aes(mean_CT_scans, govt_contributions, color = income_group), size = 2) +
labs(title="Correlation of number of diagnositc exams with spending",
subtitle = "?",
x="Number of CT scans per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_CT_scans, govt_contributions), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot with universal healthcare
merged_data %>%
ggplot() +
geom_count(aes(mean_CT_scans, govt_contributions, color = income_group), size = 2) +
labs(title="Correlation of number of diagnositc exams with Universal healthcare",
subtitle = "?",
x="Number of CT scans per 1000 population", y = "Share of govt or complusory contributions") +
geom_smooth(aes(mean_CT_scans, govt_contributions), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# hip replacement
#CT_scans <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Hip replacement")) %>%
kbl()
# hip replacement
#CT_scans <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Hip replacement")) %>%
select(c(1) | contains("per 100 000 population")) %>%
kbl()
# hip replacement
#CT_scans <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Hip replacement")) %>%
select(c(1) | contains("per 100 000 population")) %>%
select(c(1) | contains("Total")) %>%
kbl()
# hip replacement
#hip_replacement <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Hip replacement")) %>%
select(c(1) | contains("per 100 000 population")) %>%
select(c(1) | contains("Total")) %>%
rename(hip_replacement_rate = 2) %>%
# group the rows by countries and get mean of scans
group_by(country) %>%
summarise(mean_hip_replacement_rate = mean(hip_replacement_rate, na.rm = TRUE)) %>%
drop_na(2) %>%
kbl()
# hip replacement
hip_replacement <- oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Hip replacement")) %>%
select(c(1) | contains("per 100 000 population")) %>%
select(c(1) | contains("Total")) %>%
rename(hip_replacement_rate = 2) %>%
# group the rows by countries and get mean of scans
group_by(country) %>%
summarise(mean_hip_replacement_rate = mean(hip_replacement_rate, na.rm = TRUE)) %>%
drop_na(2)
########### merging ########
merged_data <- income_and_spending_with_share %>%
inner_join(hip_replacement, by = c("country"))
# Scatterplot
merged_data %>%
ggplot() +
geom_count(aes(mean_hip_replacement_rate, expenditure_to_GDP, color = income_group), size = 2) +
labs(title="Correlation of number of diagnositc exams with spending",
subtitle = "?",
x="Number of CT scans per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_hip_replacement_rate, expenditure_to_GDP), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot
merged_data %>%
ggplot() +
geom_count(aes(mean_hip_replacement_rate, expenditure_to_GDP, color = income_group), size = 2) +
labs(title="Correlation of number of hip surgeries with spending",
subtitle = "?",
x="Number of hip surgeries per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_hip_replacement_rate, expenditure_to_GDP), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot with UHC
merged_data %>%
ggplot() +
geom_count(aes(mean_hip_replacement_rate, govt_contributions, color = income_group), size = 2) +
labs(title="Correlation of number of hip surgeries with spending",
subtitle = "?",
x="Number of hip surgeries per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_hip_replacement_rate, expenditure_to_GDP), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot with UHC
merged_data %>%
ggplot() +
geom_count(aes(mean_hip_replacement_rate, govt_contributions, color = income_group), size = 2) +
labs(title="Correlation of number of hip surgeries with UHC",
subtitle = "?",
x="Number of hip surgeries per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_hip_replacement_rate, govt_contributions), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# cataract waiting
#cataract_waiting <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Cataract surgery")) %>%
kbl()
# cataract waiting
#cataract_waiting <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Cataract surgery")) %>%
select(c(1) | contains("Waiting times from specialist assessment to treatment")) %>%
kbl()
# cataract waiting
#cataract_waiting <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Cataract surgery")) %>%
select(c(1) | contains("Waiting times from specialist assessment to treatment")) %>%
select(c(1) | contains("Mean")) %>%
kbl()
# cataract waiting
#cataract_waiting <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Cataract surgery")) %>%
select(c(1) | contains("Waiting times from specialist assessment to treatment")) %>%
select(c(1) | contains("Mean")) %>%
rename(cataract_waiting = 2) %>%
# group the rows by countries and get mean of scans
group_by(country) %>%
summarise(mean_cataract_waiting_time = mean(cataract_waiting, na.rm = TRUE)) %>%
drop_na(2) %>%
kbl()
# cataract waiting
cataract_waiting <- oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Cataract surgery")) %>%
select(c(1) | contains("Waiting times from specialist assessment to treatment")) %>%
select(c(1) | contains("Mean")) %>%
rename(cataract_waiting = 2) %>%
# group the rows by countries and get mean of scans
group_by(country) %>%
summarise(mean_cataract_waiting_time = mean(cataract_waiting, na.rm = TRUE)) %>%
drop_na(2)
########### merging ########
merged_data <- income_and_spending_with_share %>%
inner_join(cataract_waiting, by = c("country"))
# Scatterplot
merged_data %>%
ggplot() +
geom_count(aes(mean_cataract_waiting_time, expenditure_to_GDP, color = income_group), size = 2) +
labs(title="Correlation of number of hip surgeries with spending",
subtitle = "?",
x="Number of hip surgeries per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_cataract_waiting_time, expenditure_to_GDP), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot
merged_data %>%
ggplot() +
geom_count(aes(mean_cataract_waiting_time, expenditure_to_GDP, color = income_group), size = 2) +
labs(title="Correlation of waiting times for cataract surgery with spending",
subtitle = "?",
x="Mean number of days for cataract surgery specilist assesement", y = "Healthcare expenditure") +
geom_smooth(aes(mean_cataract_waiting_time, expenditure_to_GDP), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot with UHC
merged_data %>%
ggplot() +
geom_count(aes(mean_cataract_waiting_time, govt_contributions, color = income_group), size = 2) +
labs(title="Correlation of number of hip surgeries with UHC",
subtitle = "?",
x="Number of hip surgeries per 1000 population", y = "Healthcare expenditure") +
geom_smooth(aes(mean_cataract_waiting_time, govt_contributions), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot with UHC
merged_data %>%
ggplot() +
geom_count(aes(mean_cataract_waiting_time, govt_contributions, color = income_group), size = 2) +
labs(title="Correlation of waiting times with UHC",
subtitle = "?",
x="Mean number of days for cataract surgery specilist assesement", y = "Healthcare expenditure") +
geom_smooth(aes(mean_cataract_waiting_time, govt_contributions), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
############################
# knee replacement
# cataract waiting
#knee_replacement <-
oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Knee replacement")) %>%
select(c(1) | contains("Waiting times of patients on the list: Mean (days)")) %>%
rename(knee_replacement = 2) %>%
# group the rows by countries and get mean of scans
group_by(country) %>%
summarise(mean_knee_replacement_waiting_time = mean(knee_replacement, na.rm = TRUE)) %>%
drop_na(2) %>%
kbl()
############################
# knee replacement
# cataract waiting
knee_replacement <- oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Knee replacement")) %>%
select(c(1) | contains("Waiting times of patients on the list: Mean (days)")) %>%
rename(knee_replacement = 2) %>%
# group the rows by countries and get mean of scans
group_by(country) %>%
summarise(mean_knee_replacement_waiting_time = mean(knee_replacement, na.rm = TRUE)) %>%
drop_na(2) %>%
kbl()
############################
# knee replacement
# cataract waiting
knee_replacement <- oecd_data %>%
# selecting country column and length of stay column
select(c(2) | contains("Knee replacement")) %>%
select(c(1) | contains("Waiting times of patients on the list: Mean (days)")) %>%
rename(knee_replacement = 2) %>%
# group the rows by countries and get mean of scans
group_by(country) %>%
summarise(mean_knee_replacement_waiting_time = mean(knee_replacement, na.rm = TRUE)) %>%
drop_na(2)
########### merging ########
merged_data <- income_and_spending_with_share %>%
inner_join(knee_replacement, by = c("country"))
# Scatterplot
merged_data %>%
ggplot() +
geom_count(aes(mean_knee_replacement_waiting_time, expenditure_to_GDP, color = income_group), size = 2) +
labs(title="Correlation of waiting times for cataract surgery with spending",
subtitle = "?",
x="Mean number of days for cataract surgery specilist assesement", y = "Healthcare expenditure") +
geom_smooth(aes(mean_knee_replacement_waiting_time, expenditure_to_GDP), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot
merged_data %>%
ggplot() +
geom_count(aes(mean_knee_replacement_waiting_time, expenditure_to_GDP, color = income_group), size = 2) +
labs(title="Correlation of waiting times for knee replacement with spending",
subtitle = "?",
x="Mean number of days for knee replacement waiting list", y = "Healthcare expenditure") +
geom_smooth(aes(mean_knee_replacement_waiting_time, expenditure_to_GDP), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
# Scatterplot with UHC
merged_data %>%
ggplot() +
geom_count(aes(mean_knee_replacement_waiting_time, govt_contributions, color = income_group), size = 2) +
labs(title="Correlation of waiting times with UHC",
subtitle = "?",
x="Mean number of days for knee replacement specilist assesement", y = "Healthcare expenditure") +
geom_smooth(aes(mean_knee_replacement_waiting_time, govt_contributions), method=lm, se=FALSE) +
scale_color_brewer(palette="Dark2") +
theme_classic()
